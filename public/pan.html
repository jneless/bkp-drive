<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>不靠谱网盘 - 文件管理</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 全局消息通知栏 -->
    <div class="notification-banner" id="notification-banner">
        <div class="notification-content">
            <div class="notification-message">
                <span class="notification-icon">⚠️</span>
                <span class="notification-text">不靠谱网盘，为用户提供0个9的可用性承诺。开源地址：https://github.com/jneless/bkp-drive/</span>
            </div>
            <button class="notification-close" id="notification-close">朕知道了</button>
        </div>
    </div>

    <div class="container">
        <header>
            <div class="header-left">
                <h1><a href="index.html" style="text-decoration: none; color: inherit;">🗂️ 不靠谱网盘</a></h1>
                <div class="breadcrumb" id="breadcrumb">
                    <span class="breadcrumb-item" data-path="">根目录</span>
                </div>
            </div>
            <div class="header-right">
                <div class="user-info" id="user-info" style="margin-right: 15px; display: none;">
                    <span class="user-greeting">👋 欢迎，<span id="username-display"></span></span>
                    <button id="logout-btn" class="btn btn-small" style="margin-left: 10px;">登出</button>
                </div>
                <button id="upload-btn" class="btn btn-primary">📤 上传文件</button>
                <button id="upload-folder-btn" class="btn btn-primary">📁 上传文件夹</button>
                <button id="new-folder-btn" class="btn btn-secondary">📁 新建文件夹</button>
            </div>
        </header>

        <div class="toolbar">
            <div class="toolbar-left">
                <button id="select-all-btn" class="btn btn-small">全选</button>
                <button id="clear-selection-btn" class="btn btn-small">取消选择</button>
                <span id="selection-count" class="selection-info">已选择: 0 项</span>
            </div>
            <div class="toolbar-right">
                <div class="view-mode-toggle">
                    <button id="list-view-btn" class="btn btn-small view-mode-btn active" title="列表视图">
                        <span>📋</span>
                    </button>
                    <button id="grid-view-btn" class="btn btn-small view-mode-btn" title="图标视图">
                        <span>🔲</span>
                    </button>
                </div>
                <button id="delete-selected-btn" class="btn btn-danger" disabled>🗑️ 删除选中</button>
                <button id="refresh-btn" class="btn btn-small">🔄 刷新</button>
            </div>
        </div>

        <div class="file-list" id="file-list">
            <div class="loading" id="loading">加载中...</div>
        </div>
    </div>

    <!-- 上传文件对话框 -->
    <input type="file" id="file-input" style="display: none;" multiple>
    <input type="file" id="folder-input" style="display: none;" webkitdirectory directory multiple>

    <!-- 新建文件夹对话框 -->
    <div id="folder-modal" class="modal">
        <div class="modal-content">
            <h3>新建文件夹</h3>
            <input type="text" id="folder-name" placeholder="请输入文件夹名称">
            <div class="modal-actions">
                <button id="create-folder-btn" class="btn btn-primary">创建</button>
                <button id="cancel-folder-btn" class="btn btn-secondary">取消</button>
            </div>
        </div>
    </div>

    <!-- 上传进度显示 -->
    <div id="upload-progress-modal" class="modal">
        <div class="modal-content">
            <h3>上传进度</h3>
            <div class="upload-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-info">
                    <span id="progress-text">正在上传...</span>
                    <span id="progress-percentage">0%</span>
                </div>
                <div class="upload-details" id="upload-details">
                    正在处理文件...
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancel-upload-btn" class="btn btn-secondary">取消上传</button>
            </div>
        </div>
    </div>

    <!-- 文件预览模态框 -->
    <div id="file-preview-modal" class="modal file-modal">
        <div class="file-modal-container">
            <!-- 左侧预览区域 -->
            <div class="file-preview-main">
                <div class="file-modal-header">
                    <div class="file-header-left">
                        <h3 id="file-title">文件预览</h3>
                        <div class="file-path" id="file-path">/</div>
                    </div>
                    <button id="close-file-modal" class="close-btn">×</button>
                </div>
                <div class="file-container">
                    <!-- 图片预览 -->
                    <img id="preview-image" src="" alt="图片预览" style="display: none;" />
                    <!-- 视频预览 -->
                    <div id="preview-video" style="display: none;">
                        <img id="video-snapshot" src="" alt="视频首帧" style="cursor: pointer;" />
                    </div>
                    <!-- PDF预览 -->
                    <div id="preview-pdf" style="display: none;">
                        <div class="pdf-placeholder">
                            <div class="pdf-icon">📄</div>
                            <p class="pdf-title">PDF 文档</p>
                            <p class="pdf-hint">暂不支持在线预览</p>
                            <p class="pdf-suggestion">请下载后查看，或使用右侧"不靠谱助手"了解文档内容</p>
                        </div>
                    </div>
                    <div class="file-loading" id="file-loading">加载中...</div>
                    <div class="file-error" id="file-error" style="display: none;">
                        <p>文件加载失败</p>
                        <button id="retry-file" class="btn btn-primary">重试</button>
                    </div>
                </div>
                <div class="file-modal-footer">
                    <button id="download-file" class="btn btn-primary">下载文件</button>
                </div>
            </div>

            <!-- 右侧不靠谱助手 -->
            <div class="bkp-assistant-sidebar">
                <div class="assistant-header">
                    <h3>🤖 不靠谱助手</h3>
                    <button id="toggle-assistant" class="btn btn-small">收起</button>
                </div>
                <div class="assistant-content">
                    <div class="chat-messages" id="chat-messages">
                        <div class="assistant-welcome">
                            <p>👋 你好！我可以帮你理解这个文件的内容。</p>
                        </div>
                    </div>
                    <div class="chat-input-area">
                        <textarea id="chat-input" placeholder="输入消息..." rows="3"></textarea>
                        <button id="send-message" class="btn btn-primary">发送</button>
                    </div>
                </div>
            </div>

            <!-- 展开助手按钮 -->
            <button id="expand-assistant-btn" class="expand-assistant-btn" style="display: none;">
                <span>🤖</span>
                <span class="expand-text">展开助手</span>
            </button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>